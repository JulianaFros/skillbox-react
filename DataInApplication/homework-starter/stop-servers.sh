#!/bin/bash

echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —Å–µ—Ä–≤–µ—Ä—ã..."

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç–∞—Ö
lsof -ti:4000 | xargs kill -9 2>/dev/null
lsof -ti:5173 | xargs kill -9 2>/dev/null

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ –∏–º–µ–Ω–∏
pkill -9 -f "tsx watch" 2>/dev/null
pkill -9 -f "vite" 2>/dev/null

sleep 1

# –ü—Ä–æ–≤–µ—Ä–∫–∞
if ! lsof -i :4000 -i :5173 2>/dev/null | grep -q LISTEN; then
    echo "‚úÖ –í—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
else
    echo "‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤—Å—ë –µ—â—ë –∑–∞–ø—É—â–µ–Ω—ã:"
    lsof -i :4000 -i :5173
fi
